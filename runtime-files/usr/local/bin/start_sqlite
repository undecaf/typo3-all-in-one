#!/bin/bash

#
# Sets up SQLite
#

set -e

# Use the same environment as during build
. /etc/environment
SQLITE_DIR=$TYPO3_ROOT/var/sqlite

# Set up SQLite if necessary
if [ ! -d $SQLITE_DIR ]; then
    logger -p $LOG_INFO 'Setting up SQLite'

    # Point the SQLite directory at the database volume
    mkdir -p $TYPO3_ROOT/var
    ln -s $TYPO3_DATADIR $SQLITE_DIR
    chown -R ${APACHE_USER}: $TYPO3_ROOT/var $TYPO3_DATADIR
fi

# Nothing to start
logger -p $LOG_INFO 'SQLite ready'
